<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8">
		<link rel="stylesheet" href="./css/product_customer.css">
	</head>
	<body>
		<div class="body">
			<header>
				<div class="header-menu">
					<i class="bag-icon"></i>
					<span class="user-greet">Hello, <i>Donat Travin</i></span>
					<i class="logout-icon"></i>
				</div>
			</header>
			<main>
				<div class="navigation-bar">
					<span class="back-link navigation-link"><a href="/">Back</a></span>
					<span class="category-path navigation-link">Category: <a href="/">Man / Acive wear</a></span>
				</div>
				<div class="product-block">
					<div class="product-img">
						<div class="block_slider_wrapper">
							<div class="block-image-slider">
							</div>
							<span class="nvgt" id="prev"></span>
							<span class="nvgt" id="next"></span>
						</div>
						<div class="product-rating">
							<i class="gold-star rating-start"></i>
							<i class="gold-star rating-start"></i>
							<i class="gold-star rating-start"></i>
							<i class="star rating-start"></i>
							<i class="star rating-start"></i>
						</div>
						<canvas class="zoomed-img"></canvas>
					</div>
					<div class="product-details">
						<p class="product-name">Active Coat Lorem 2</p>
						<div class="product-description">
							Lorem ipsum dolor sit amet, consectetur adipisicing
							elit. Adipisci aperiam, libero aliquid architecto ad quis
							maiores sit nulla officiis.
						</div>
						<span class="product-price"><i class="currency">$</i>716.45<span class="product-qty">(10 items left)</span></span>
						<button for="success_purchased_modal" class="btn primary-btn buy-product-btn modal-open-close-button">Buy</button>
					</div>
				</div>
				<div class="add-review-lable">There is no user reviews for now.
					Would you like to
					<span class="closed-label"><span class="open-label">share your thoughts with other customers</span>?</span>
					<span class="opened-label" hidden>Share your thoughts with other customers:</span>
				</div>
				<div class="product-review">
					<div class="review-preview">
						<div class="product-rating-viewer" hidden>
							<i class="star rating-start"></i>
							<i class="star rating-start"></i>
							<i class="star rating-start"></i>
							<i class="star rating-start"></i>
							<i class="star rating-start"></i>
						</div>
						<p class="review-info">By<span class="user-name">Your Name</span><span class="review-date"></span></p>
						<div class="review-text-info">
							<img class="review-avatar"/>
							<div class="review-preview-text"></div>
						</div>
					</div>
					<div class="review-editor">
						<div class="label">EDIT YOUR REVIEW</div>
						<div class="user-info">
							<label for="userName">Enter your name:</label>
							<input type="text" id="userName" class="user-name">
							<label for="avatar">Choose your avatar:</label>
							<input type="file" id="avatar" class="avatar">
							<div class="file-styled-label">
								<span class="empty-avatar label">Image not selected</span>
								<span class="selected-avatar label" hidden>Image selected</span>
								<img class="avatar-img"/>
							</div>
						</div>
						<div class="review-text-editor">
							<div class="product-rating-editor">
								<span class="label">Rate product:</span>
								<i class="grey-star rating-start" data-rating="1"></i>
								<i class="grey-star rating-start" data-rating="2"></i>
								<i class="grey-star rating-start" data-rating="3"></i>
								<i class="grey-star rating-start" data-rating="4"></i>
								<i class="grey-star rating-start" data-rating="5"></i>
							</div>
							<label for="review">Write your review:</label>
							<textarea id="review" class="review-text"></textarea>
							<div class="buttons-container">
								<div class="left-side">
									<button class="btn secondary-btn bold-btn">Bold</button>
									<button class="btn secondary-btn emphasize-btn">Emphasize</button>
									<button class="btn secondary-btn quote-btn">Quote</button>
								</div>
								<div class="right-side">
									<button class="btn secondary-btn cancel-btn">Cancel</button>
									<button class="btn primary-btn add-btn">Add Review</button>
								</div>
							</div>
						</div>
					</div>
				</div>
			</main>
			<footer>
				Copyright “Demo Shop”, 2017
			</footer>
		</div>
	</body>
	<script src="slider.js"></script>
	<script src="fadeSlider.js"></script>
	<script src="horizontalSlider.js"></script>
	<script src="zoomer.js"></script>
	<script src="utilites.js"></script>
	<script src="product_customer.js"></script>
<script>
	var months = {
		0: 'January',
		1: 'February',
		2: 'March',
		3: 'April',
		4: 'May',
		5: 'June',
		6: 'Jule',
		7: 'August',
		8: 'September',
		9: 'October',
		10: 'November',
		11: 'December'
	};

	var userNameInput = document.querySelector('.review-editor .user-name');
	var userNameOutput = document.querySelector('.review-preview .user-name');

	var avatarInput = document.querySelector('.review-editor .avatar');
	var avatarUploadOuput = document.querySelector('.review-editor .avatar-img');
	var avatarOutput = document.querySelector('.review-preview .review-avatar');
	var avatarEmptyLabel = document.querySelector('.review-editor .empty-avatar.label');
	var avatarSelectedLabel = document.querySelector('.review-editor .selected-avatar.label');

	var productRatingEditorInputs = document.querySelectorAll('.review-editor .product-rating-editor i');
	var productRatingEditorOutputs = document.querySelector('.review-preview .product-rating-viewer');

	var reviewTextInput = document.querySelector('.review-editor .review-text');
	var reviewTextOutput = document.querySelector('.review-preview .review-preview-text');

	var boldBtn = document.getElementsByClassName('bold-btn')[0];
	var emphasizeBtn = document.getElementsByClassName('emphasize-btn')[0];
	var quoteBtn = document.getElementsByClassName('quote-btn')[0];
	var reviewDate = document.getElementsByClassName('review-date')[0];

	var openReviewEditorLabel = document.querySelector('.add-review-lable .open-label');
	var closedReviewEditorLabel = document.querySelector('.add-review-lable .closed-label');
	var openedReviewEditorLabel = document.querySelector('.add-review-lable .opened-label');
	var productReview = document.querySelector('.product-review');

	var cancelBtn = document.getElementsByClassName('cancel-btn')[0];

	var date = new Date();

	reviewDate.textContent = `${date.getDate()} ${months[date.getMonth()]} , ${date.getFullYear()}`;

	openReviewEditorLabel.addEventListener('click', function () {
		productReview.style['display'] = 'block';
		closedReviewEditorLabel.setAttribute('hidden', 'hidden');
		openedReviewEditorLabel.removeAttribute(('hidden'));
	});

	cancelBtn.addEventListener('click', function () {
		productReview.style['display'] = 'none';
		openedReviewEditorLabel.setAttribute('hidden', 'hidden');
		closedReviewEditorLabel.removeAttribute(('hidden'));
	});

	userNameInput.addEventListener('input', function () {
		userNameOutput.textContent = userNameInput.value || 'Your name';
	});

	reviewTextInput.addEventListener('input', function () {
		var regexp = /\[(\/?)([bqi])\]/g;
		var result = reviewTextInput.value.replace(regexp, '<$1$2>')
			.replace(/\n/g, '<br>');
		reviewTextOutput.innerHTML = result || '';
	});

	boldBtn.addEventListener('click', function () {
		var start = reviewTextInput.selectionStart;
		var end = reviewTextInput.selectionEnd;
		var result = reviewTextInput.value;
		if (start < end) {
			result = reviewTextInput.value.slice(0, start) + '[b]' + reviewTextInput.value.slice(start, end) +
					'[/b]' + reviewTextInput.value.slice(end);
		} else {
			result = reviewTextInput.value + '[b][/b]';
		}

		reviewTextInput.value = result;
		var event = document.createEvent('Event');
		event.initEvent('input', true, true);
		reviewTextInput.dispatchEvent(event);
	});

	emphasizeBtn.addEventListener('click', function () {
		var start = reviewTextInput.selectionStart;
		var end = reviewTextInput.selectionEnd;
		var result = reviewTextInput.value;
		if (start < end) {
			result = reviewTextInput.value.slice(0, start) + '[i]' + reviewTextInput.value.slice(start, end) +
					'[/i]' + reviewTextInput.value.slice(end);
		} else {
			result = reviewTextInput.value + '[i][/i]';
		}

		reviewTextInput.value = result;
		var event = document.createEvent('Event');
		event.initEvent('input', true, true);
		reviewTextInput.dispatchEvent(event);
	});

	quoteBtn.addEventListener('click', function () {
		var start = reviewTextInput.selectionStart;
		var end = reviewTextInput.selectionEnd;
		var result = reviewTextInput.value;
		if (start < end) {
			result = reviewTextInput.value.slice(0, start) + '[q]' + reviewTextInput.value.slice(start, end) +
					'[/q]' + reviewTextInput.value.slice(end);
		} else {
			result = reviewTextInput.value + '[q][/q]';
		}

		reviewTextInput.value = result;
		var event = document.createEvent('Event');
		event.initEvent('input', true, true);
		reviewTextInput.dispatchEvent(event);
	});

	avatarInput.addEventListener('change', function (e) {
		var file = this.files[0];
		var fr = new FileReader();
		fr.onload = (function (file) {
			return function (e) {
				var data = e.target.result;
				avatarOutput.src = data;
				avatarUploadOuput.src = data;
				avatarSelectedLabel.removeAttribute('hidden');
				avatarEmptyLabel.setAttribute('hidden', 'hidden');
			}
		})(file);

		fr.readAsDataURL(file);
	})

	productRatingEditorInputs.forEach(input => {
		input.addEventListener('click', function (event) {
			var rating = event.currentTarget.dataset["rating"];

			for (var i = 0; i < productRatingEditorInputs.length; i++) {
				if (i < rating) {
					productRatingEditorInputs[i].classList.remove('grey-star');
					productRatingEditorInputs[i].classList.add('gold-star');

					productRatingEditorOutputs.removeAttribute('hidden');
					productRatingEditorOutputs.children[i].classList.remove('star');
					productRatingEditorOutputs.children[i].classList.add('gold-star');
				} else {
					productRatingEditorInputs[i].classList.remove('gold-star');
					productRatingEditorInputs[i].classList.add('grey-star');
					productRatingEditorOutputs.children[i].classList.add('star');
					productRatingEditorOutputs.children[i].classList.remove('gold-star');
				}
			}
		});
	})
</script>
</html>